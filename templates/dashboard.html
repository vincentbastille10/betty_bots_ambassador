{% extends "base.html" %}
{% block title %}Dashboard Ambassadeur Betty Bot{% endblock %}

{% block content %}

{% if not_found %}
  <div class="card" style="text-align:center;">
    <h2>Dashboard introuvable</h2>
    <p class="lead">
      Nous nâ€™avons pas rÃ©ussi Ã  retrouver votre compte ambassadeur.
    </p>
    <p class="muted">
      VÃ©rifiez que vous avez bien utilisÃ© le lien reÃ§u aprÃ¨s votre inscription.<br>
      En cas de doute, rÃ©inscrivez-vous avec la mÃªme adresse email : vous
      rÃ©cupÃ©rerez automatiquement votre code existant.
    </p>
    <div style="margin-top:14px;">
      <a href="{{ url_for('inscription') }}" class="btn-primary">
        Revenir Ã  la page dâ€™inscription
      </a>
    </div>
  </div>
{% else %}
  <div class="card">
    <h2 style="margin-top:0;">
      Bonjour {{ ambassador.name }} ğŸ‘‹
    </h2>
    <p class="lead">
      Voici votre espace ambassadeur Betty Bot. Vous y retrouvez votre lien Ã  partager,
      vos chiffres, et les scripts pour convaincre vos clients.
    </p>

    <div style="
      display:flex;
      flex-wrap:wrap;
      gap:14px;
      margin-top:10px;
      align-items:flex-start;
    ">
      <div style="flex:1 1 260px;min-width:240px;">
        <div class="field-label">Votre code ambassadeur</div>
        <div class="tag" style="font-size:13px;">
          ğŸ”‘ {{ ambassador.code }}
        </div>

        <div class="field-group" style="margin-top:10px;">
          <div class="field-label">Lien principal Ã  partager Ã  vos clients</div>
          <div style="
            padding:8px 10px;
            border-radius:10px;
            border:1px solid rgba(148,163,184,0.6);
            background:rgba(15,23,42,0.9);
            font-size:13px;
            word-break:break-all;
          ">
            {{ stats.tracking_link }}
          </div>
          <div class="hint">
            Câ€™est ce lien que vous pouvez envoyer par email, SMS, WhatsApp, rÃ©seaux sociaux, etc.
          </div>
        </div>

        <div class="field-group">
          <div class="field-label">Lien court (optionnel)</div>
          <div style="
            padding:8px 10px;
            border-radius:10px;
            border:1px solid rgba(148,163,184,0.6);
            background:rgba(15,23,42,0.9);
            font-size:13px;
            word-break:break-all;
          ">
            {{ stats.short_link }}
          </div>
          <div class="hint">
            Ce lien passe par la plateforme ambassadeur, enregistre le clic, puis redirige vers le mÃªme endroit.
          </div>
        </div>
      </div>

      <div style="flex:1 1 260px;min-width:240px;">
        <div class="field-label">RÃ©sumÃ© de vos rÃ©sultats</div>
        <div style="display:flex;flex-wrap:wrap;gap:10px;">
          <div style="
            flex:1 1 120px;
            padding:10px 12px;
            border-radius:12px;
            border:1px solid rgba(148,163,184,0.7);
            background:rgba(15,23,42,0.95);
            font-size:13px;
          ">
            <div class="muted">Clics sur vos liens</div>
            <div style="font-size:20px;font-weight:700;margin-top:4px;">
              {{ stats.clicks }}
            </div>
          </div>

          <div style="
            flex:1 1 120px;
            padding:10px 12px;
            border-radius:12px;
            border:1px solid rgba(148,163,184,0.7);
            background:rgba(15,23,42,0.95);
            font-size:13px;
          ">
            <div class="muted">Abonnements confirmÃ©s</div>
            <div style="font-size:20px;font-weight:700;margin-top:4px;">
              {{ stats.signups }}
            </div>
            <div class="hint">
              Ce chiffre pourra Ãªtre reliÃ© plus tard Ã  Stripe pour suivre les ventes rÃ©elles.
            </div>
          </div>
        </div>

        <div class="sep"></div>

        <div style="font-size:13px;">
          <div class="field-label">Estimation de vos commissions</div>
          <ul style="padding-left:18px;margin:0;">
            <li>
              Prime dâ€™inscription par abonnement&nbsp;:
              <strong>{{ '%.2f'|format(stats.upfront_per) }}&nbsp;â‚¬</strong>
            </li>
            <li>
              Estimation totale des primes (tous abonnements)&nbsp;:
              <strong>{{ '%.2f'|format(stats.est_upfront_total) }}&nbsp;â‚¬</strong>
            </li>
            <li>
              RÃ©current mensuel (si tous les abonnements sont encore actifs)&nbsp;:
              <strong>{{ '%.2f'|format(stats.est_monthly_recurring) }}&nbsp;â‚¬ / mois</strong>
            </li>
            <li>
              Estimation sur 6 mois (prime + 6 mois de rÃ©current)&nbsp;:
              <strong>{{ '%.2f'|format(stats.est_6m_total) }}&nbsp;â‚¬</strong>
            </li>
          </ul>
          <p class="hint" style="margin-top:4px;">
            Ces montants sont indicatifs. Le calcul rÃ©el dÃ©pendra de la durÃ©e
            de chaque abonnement. Vous pourrez affiner plus tard avec les vraies donnÃ©es Stripe.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Onglets scripts + explications client -->
  <div class="card">
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px;">
      <button type="button"
              class="btn-primary"
              id="tab-btn-scripts"
              style="padding:8px 14px;font-size:13px;">
        ğŸ—£ï¸ Scripts pour convaincre vos clients
      </button>
      <button type="button"
              class="btn-ghost"
              id="tab-btn-explications"
              style="padding:8px 14px;font-size:13px;">
        âš™ï¸ Comment expliquer la mise en place du bot
      </button>
    </div>

    <!-- Onglet 1 : scripts de vente -->
    <div id="tab-scripts">
      <h3 style="margin-top:0;">Scripts prÃªts Ã  lâ€™emploi</h3>
      <p class="muted" style="margin-bottom:12px;">
        Vous pouvez copier-coller ces scripts dans vos emails, messages ou appels tÃ©lÃ©phoniques.
        Adaptez les formulations avec vos propres mots si besoin.
      </p>

      <h4>1. Script pour artisans, commerÃ§ants, petites entreprises</h4>
      <p class="hint">
        (Plombier, coiffeur, garage, restaurant, boutique, etc.)
      </p>
      <div style="
        padding:10px 12px;
        border-radius:12px;
        border:1px solid rgba(148,163,184,0.7);
        background:rgba(15,23,42,0.98);
        font-size:13px;
        white-space:pre-line;
      ">
Â« Bonjour, je vous appelle pour quelque chose de trÃ¨s concret : vous perdez sÃ»rement des clients
quand vous ne pouvez pas rÃ©pondre au tÃ©lÃ©phone ou aux messages.

Je travaille avec une solution qui sâ€™appelle Betty Bot : câ€™est une assistante IA qui discute avec
les personnes Ã  votre place quand vous Ãªtes en rendez-vous, en dÃ©placement ou fermÃ©.

ConcrÃ¨tement, au lieu que le prospect raccroche et aille chez un concurrent, Betty lui pose
quelques questions simples (nom, tÃ©lÃ©phone, ce quâ€™il recherche) et vous envoie un message clair
avec un client â€œprÃªt Ã  rappelerâ€.

Ce nâ€™est pas un robot froid : on la configure pour quâ€™elle parle avec votre ton, votre style.
Le tarif est de 79,90 â‚¬ / mois, sans engagement, avec 7 jours gratuits pour voir si Ã§a vous apporte
vraiment quelque chose.

Si vous voulez, je peux vous envoyer mon lien : vous regardez la prÃ©sentation tranquillement,
et si Ã§a vous parle, on met en place votre Betty en quelques minutes. Â»
      </div>

      <h4 style="margin-top:18px;">2. Script pour coachs, thÃ©rapeutes, mÃ©tiers de lâ€™accompagnement</h4>
      <p class="hint">
        (Coach, psychologue, sophrologue, hypnothÃ©rapeute, praticien bien-Ãªtre, etc.)
      </p>
      <div style="
        padding:10px 12px;
        border-radius:12px;
        border:1px solid rgba(148,163,184,0.7);
        background:rgba(15,23,42,0.98);
        font-size:13px;
        white-space:pre-line;
      ">
Â« Bonjour, je vous contacte car je sais quâ€™en tant que thÃ©rapeute / coach, vous ne pouvez pas rÃ©pondre
au tÃ©lÃ©phone pendant vos sÃ©ances, et câ€™est normal. Le problÃ¨me, câ€™est que beaucoup de personnes
nâ€™osent pas rappeler ensuite.

Je travaille avec une assistante IA qui sâ€™appelle Betty Bot. Elle ne donne aucun conseil mÃ©dical ou
psychologique, mais elle accueille les personnes sur votre site ou votre page, les rassure, pose
2â€“3 questions (nom, email, tÃ©lÃ©phone, pourquoi elles vous contactent), puis vous envoie un message clair.

Lâ€™idÃ©e nâ€™est pas de vous remplacer, mais de crÃ©er un premier contact doux et humain, mÃªme quand vous
Ãªtes en sÃ©ance. Vous gardez la main sur la relation : câ€™est vous qui rappelez quand vous Ãªtes disponible.

Le prix est de 79,90 â‚¬ / mois, sans engagement, avec une semaine dâ€™essai. Si vous voulez,
je vous envoie le lien de prÃ©sentation : vous pourrez voir Ã  quoi ressemble Betty et comment elle
peut sâ€™adapter Ã  votre pratique. Â»
      </div>
    </div>

    <!-- Onglet 2 : explication parcours client -->
    <div id="tab-explications" style="display:none;">
      <h3 style="margin-top:0;">Comment expliquer la mise en place du bot Ã  votre client</h3>
      <p class="muted" style="margin-bottom:10px;">
        Voici une faÃ§on simple dâ€™expliquer au client ce qui se passe une fois quâ€™il clique sur votre lien.
      </p>

      <ol style="padding-left:18px;font-size:13px;margin:0;">
        <li style="margin-bottom:8px;">
          <strong>Inscription Ã  Betty Bot</strong><br>
          Votre client arrive sur la page Betty (<code>spectramedia.online</code>), dÃ©couvre
          lâ€™offre et clique sur le bouton pour configurer son bot. Il souscrit Ã  lâ€™abonnement
          de 79,90 â‚¬ / mois (via Stripe, paiement sÃ©curisÃ©).
        </li>
        <li style="margin-bottom:8px;">
          <strong>Configuration du chatbot</strong><br>
          Il choisit son mÃ©tier, la couleur, lâ€™avatar, le ton, et renseigne ses coordonnÃ©es
          (nom, email, tÃ©lÃ©phoneâ€¦). Tout se fait en quelques minutes.
        </li>
        <li style="margin-bottom:8px;">
          <strong>RÃ©ception du script par email</strong><br>
          Une fois la configuration terminÃ©e, il reÃ§oit un email avec son
          <strong>script dâ€™intÃ©gration</strong> (le code Ã  coller sur son site).  
          ğŸ‘‰ Lui dire de <strong>vÃ©rifier ses spams</strong> si lâ€™email nâ€™arrive pas.
        </li>
        <li style="margin-bottom:8px;">
          <strong>IntÃ©gration du bot sur son site</strong><br>
          Le script tient sur 2 lignes. Le client peut :
          <ul style="padding-left:18px;margin:4px 0;">
            <li>soit lâ€™envoyer Ã  son dÃ©veloppeur / webmaster,</li>
            <li>soit le coller lui-mÃªme dans un bloc â€œHTML / Widgetâ€ sur son site Wix, WordPress, etc.</li>
          </ul>
          Une fois collÃ© et enregistrÃ©, le bouton / widget Betty apparaÃ®t sur son site.
        </li>
        <li>
          <strong>Betty commence Ã  travailler</strong><br>
          DÃ¨s que le script est en place, Betty accueille les visiteurs,
          pose les questions importantes et envoie les leads au client par email
          ou dans son espace dÃ©diÃ©.
        </li>
      </ol>

      <p class="hint" style="margin-top:8px;">
        En rÃ©sumÃ© : <strong>vous</strong> amenez le client sur la page Betty avec votre lien,
        <strong>Betty</strong> sâ€™occupe de lâ€™inscription et de lâ€™assistant IA, et vous touchez
        votre commission sur chaque abonnement.
      </p>
    </div>
  </div>
{% endif %}

{% endblock %}

{% block scripts %}
<script>
  // Petit switch dâ€™onglets local (sans autre fichier)
  const tabBtnScripts = document.getElementById('tab-btn-scripts');
  const tabBtnExp = document.getElementById('tab-btn-explications');
  const tabScripts = document.getElementById('tab-scripts');
  const tabExp = document.getElementById('tab-explications');

  if (tabBtnScripts && tabBtnExp && tabScripts && tabExp) {
    tabBtnScripts.addEventListener('click', () => {
      tabScripts.style.display = '';
      tabExp.style.display = 'none';
      tabBtnScripts.classList.add('btn-primary');
      tabBtnScripts.classList.remove('btn-ghost');
      tabBtnExp.classList.add('btn-ghost');
      tabBtnExp.classList.remove('btn-primary');
    });

    tabBtnExp.addEventListener('click', () => {
      tabScripts.style.display = 'none';
      tabExp.style.display = '';
      tabBtnExp.classList.add('btn-primary');
      tabBtnExp.classList.remove('btn-ghost');
      tabBtnScripts.classList.add('btn-ghost');
      tabBtnScripts.classList.remove('btn-primary');
    });
  }
</script>
{% endblock %}
