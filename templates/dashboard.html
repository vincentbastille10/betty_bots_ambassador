{% extends "base.html" %}
{% block content %}

{% if not ambassador %}
  <!-- Cas : ref inconnu -->
  <section style="
        margin-top:12px;
        padding:40px 20px 42px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top,#020617,#020617);
        text-align:center;
      ">
    <h1 style="font-size:1.6rem;margin-bottom:10px;">Dashboard introuvable</h1>
    <p style="font-size:14px;color:var(--muted);max-width:520px;margin:0 auto 18px;">
      Nous n’avons pas réussi à retrouver votre compte ambassadeur.
      Vérifiez que vous utilisez le lien reçu après votre inscription.
      En cas de doute, réinscrivez-vous avec la même adresse email : votre code sera récupéré automatiquement.
    </p>
    <a href="{{ url_for('inscription') }}"
       style="display:inline-block;padding:11px 22px;border-radius:999px;
              background:linear-gradient(90deg,#6366f1,#ec4899);color:#f9fafb;
              font-weight:600;font-size:14px;text-decoration:none;">
      Revenir à la page d’inscription
    </a>
  </section>
{% else %}

<section style="display:flex;flex-wrap:wrap;gap:22px;margin-top:6px;">

  <!-- Colonne gauche : stats & lien à partager -->
  <div style="
        flex:1 1 340px;
        min-width:280px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top left,#020617,#020617);
        padding:22px 20px 20px;
        box-shadow:0 22px 70px rgba(15,23,42,0.9);
      ">
    <h1 style="font-size:1.7rem;line-height:1.1;margin-bottom:6px;">
      Bonjour {{ ambassador.name or ambassador.email }},
    </h1>
    <p style="font-size:14px;color:var(--muted);margin-bottom:16px;">
      voici un aperçu de vos performances avec le programme ambassadeur Betty Bot.
    </p>

    <!-- Stats -->
    <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:14px;">
      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Abonnements générés</div>
        <div style="font-size:20px;font-weight:700;">
          {{ total_sales or 0 }}
        </div>
      </div>

      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Commissions estimées</div>
        <div style="font-size:20px;font-weight:700;">
          {{ "%.2f"|format(total_commission or 0) }} €
        </div>
      </div>

      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Clics sur votre lien</div>
        <div style="font-size:20px;font-weight:700;">
          {{ total_clicks or 0 }}
        </div>
      </div>
    </div>

    <!-- Lien à partager -->
    <div style="
          margin-top:6px;
          padding:12px 13px;
          border-radius:16px;
          border:1px solid rgba(148,163,184,0.6);
          background:rgba(15,23,42,0.9);
          font-size:13px;
        ">
      <div style="font-weight:600;margin-bottom:6px;">Votre lien Betty Bot à partager</div>
      <p style="margin-bottom:6px;color:var(--muted);">
        Tous les abonnements pris via ce lien seront automatiquement associés à votre compte ambassadeur.
      </p>
      <p style="word-break:break-all;margin-bottom:6px;">
        <a href="{{ betty_link }}" target="_blank" rel="noopener"
           style="color:#a5b4fc;text-decoration:underline;">
          {{ betty_link }}
        </a>
      </p>
      <p style="font-size:11px;color:var(--muted);">
        Vous pouvez l’utiliser dans vos emails, messages privés, publications réseaux sociaux, etc.
      </p>
    </div>

    <!-- Rappel commissions -->
    <div style="margin-top:14px;font-size:12px;color:var(--muted);">
      Rappel : vous touchez <strong>30&nbsp;% de la première mensualité</strong> (≈24&nbsp;€)
      puis <strong>10&nbsp;€ / mois</strong> tant que chaque abonnement reste actif.
      Les versements sont effectués selon le mode indiqué lors de votre inscription.
    </div>
  </div>

  <!-- Colonne droite : scripts + explication client -->
  <div style="
        flex:1 1 320px;
        min-width:280px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top right,rgba(99,102,241,0.25),#020617 55%);
        padding:22px 20px 22px;
      ">
    <!-- Onglets "contenu" très simple -->
    <div style="margin-bottom:14px;">
      <div style="font-size:13px;color:var(--muted);margin-bottom:4px;">
        Outils pour vendre Betty Bot
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <div style="
              padding:6px 10px;
              border-radius:999px;
              border:1px solid rgba(148,163,184,0.6);
              font-size:11px;
              background:rgba(15,23,42,0.9);
            ">
          Scripts conseillés
        </div>
        <div style="
              padding:6px 10px;
              border-radius:999px;
              border:1px solid rgba(148,163,184,0.35);
              font-size:11px;
              background:rgba(15,23,42,0.6);
            ">
          Comment ça se passe pour le client
        </div>
      </div>
    </div>

    <!-- Scripts de vente -->
    <div style="
          padding:12px 13px;
          border-radius:16px;
          border:1px solid var(--border);
          background:#020617;
          font-size:13px;
          margin-bottom:14px;
        ">
      <h2 style="font-size:1rem;margin-bottom:6px;">Scripts pour convaincre vos clients</h2>
      <p style="color:var(--muted);margin-bottom:8px;">
        Voici deux scripts prêts à l’emploi que vous pouvez adapter à votre ton.
      </p>

      <details open style="margin-bottom:8px;">
        <summary style="cursor:pointer;font-weight:600;margin-bottom:4px;">
          Script 1 – Artisans / commerçants
        </summary>
        <pre style="
              white-space:pre-wrap;
              font-size:12px;
              margin-top:4px;
              background:#020617;
              border-radius:8px;
              padding:8px;
              border:1px solid rgba(31,41,55,0.9);
            ">
Bonjour, je me permets de vous contacter parce que je travaille avec un assistant virtuel
qui aide les artisans et commerçants à ne plus perdre de clients quand ils sont occupés.

Concrètement, quand quelqu’un arrive sur votre site ou votre page, Betty discute avec lui,
pose quelques questions simples (nom, téléphone, ce qu’il cherche) et vous envoie tout
par email. Vous rappelez uniquement les personnes vraiment intéressées.

Ce n’est pas un robot froid : elle parle comme une vraie personne, 24h/24,
et vous pouvez personnaliser son ton à votre image. L’abonnement est à 79,90 €/mois,
sans engagement, et je peux vous envoyer un lien pour voir comment ça fonctionne.

Est-ce que vous avez déjà un site ou une page où on pourrait installer Betty Bot ?
            </pre>
      </details>

      <details>
        <summary style="cursor:pointer;font-weight:600;margin-bottom:4px;">
          Script 2 – Coachs / thérapeutes / professions d’accompagnement
        </summary>
        <pre style="
              white-space:pre-wrap;
              font-size:12px;
              margin-top:4px;
              background:#020617;
              border-radius:8px;
              padding:8px;
              border:1px solid rgba(31,41,55,0.9);
            ">
Je vous contacte parce que beaucoup de coachs et de thérapeutes perdent des demandes
de rendez-vous simplement parce qu’ils ne peuvent pas répondre tout de suite.

Betty Bot est une assistante virtuelle spécialisée : elle accueille vos visiteurs,
explique votre activité avec vos mots, prend les coordonnées (nom, email, téléphone)
et le motif de la demande, puis vous envoie un récap clair à traiter quand vous êtes disponible.

L’idée n’est pas de remplacer votre relation humaine, mais de filtrer,
d’organiser, et de rassurer les personnes qui arrivent chez vous de jour comme de nuit.

L’abonnement est à 79,90 €/mois, sans engagement. Si vous le souhaitez,
je vous envoie un lien de démonstration et vous verrez exactement
comment Betty peut travailler pour vous en arrière-plan.
            </pre>
      </details>
    </div>

    <!-- Explication parcours client -->
    <div style="
          padding:12px 13px;
          border-radius:16px;
          border:1px solid var(--border);
          background:#020617;
          font-size:13px;
        ">
      <h2 style="font-size:1rem;margin-bottom:6px;">Comment ça se passe pour vos clients&nbsp;?</h2>
      <ol style="margin-left:16px;color:var(--muted);line-height:1.6;">
        <li>
          <strong>Inscription à Betty Bot</strong><br>
          Votre contact clique sur votre lien Betty Bot. Il arrive sur la page officielle,
          choisit son métier, remplit ses informations, puis procède au paiement
          sécurisé via Stripe (abonnement 79,90&nbsp;€ / mois).
        </li>
        <li>
          <strong>Configuration du chatbot</strong><br>
          Après paiement, il est redirigé vers la page de configuration :
          couleur, avatar, message d’accueil, texte d’introduction, coordonnées de contact, etc.
          Tout se fait en quelques minutes.
        </li>
        <li>
          <strong>Réception du script par email</strong><br>
          Il reçoit automatiquement un email avec son <strong>script d’intégration</strong>
          (quelques lignes de code à copier-coller) et un récap de son bot.  
          Il doit vérifier ses spams si l’email n’apparaît pas.
        </li>
        <li>
          <strong>Intégration sur le site</strong><br>
          – S’il gère son site lui-même (WordPress, Wix, Webflow…), il ajoute simplement un
          «&nbsp;widget&nbsp;» ou un bloc «&nbsp;code HTML&nbsp;» et colle le script.<br>
          – S’il travaille avec un développeur ou une agence, il leur transmet l’email :
          le script tient sur quelques lignes et s’ajoute très facilement.
        </li>
        <li>
          <strong>Betty commence à travailler</strong><br>
          Une fois le script en place, Betty apparaît sur le site et commence à discuter
          avec les visiteurs. Les leads sont envoyés par email (et/ou dans l’outil que
          vous avez prévu par la suite).
        </li>
      </ol>
      <p style="font-size:12px;color:var(--muted);margin-top:8px;">
        Vous n’avez rien à gérer techniquement : votre rôle est simplement d’expliquer
        la valeur de Betty, d’envoyer votre lien, et de suivre vos résultats ici dans le dashboard.
      </p>
    </div>
  </div>
</section>

{% endif %}

{% endblock %}
