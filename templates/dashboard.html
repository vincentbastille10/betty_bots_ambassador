{% extends "base.html" %}
{% block content %}

{% if not ambassador %}
  <!-- Cas : ref / code inconnu -->
  <section style="
        margin-top:12px;
        padding:40px 20px 42px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top,#020617,#020617);
        text-align:center;
      ">
    <h1 style="font-size:1.6rem;margin-bottom:10px;">Dashboard introuvable</h1>
    <p style="font-size:14px;color:var(--muted);max-width:520px;margin:0 auto 18px;">
      Nous nâ€™avons pas rÃ©ussi Ã  retrouver votre compte ambassadeur.
      VÃ©rifiez que vous utilisez bien le lien reÃ§u aprÃ¨s votre inscription.
      En cas de doute, rÃ©inscrivez-vous avec la mÃªme adresse email : votre code sera rÃ©cupÃ©rÃ© automatiquement.
    </p>
    <a href="{{ url_for('inscription') }}"
       style="display:inline-block;padding:11px 22px;border-radius:999px;
              background:linear-gradient(90deg,#6366f1,#ec4899);color:#f9fafb;
              font-weight:600;font-size:14px;text-decoration:none;">
      Revenir Ã  la page dâ€™inscription
    </a>
  </section>

{% else %}

<section style="display:flex;flex-wrap:wrap;gap:22px;margin-top:6px;">

  <!-- Colonne gauche : stats & lien Ã  partager -->
  <div style="
        flex:1 1 340px;
        min-width:280px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top left,#020617,#020617);
        padding:22px 20px 20px;
        box-shadow:0 22px 70px rgba(15,23,42,0.9);
      ">
    <h1 style="font-size:1.7rem;line-height:1.1;margin-bottom:6px;">
      Bonjour {{ ambassador.name or ambassador.email }},
    </h1>
    <p style="font-size:14px;color:var(--muted);margin-bottom:16px;">
      voici un aperÃ§u de vos performances avec le programme ambassadeurs Betty Bot.
    </p>

    <!-- Stats -->
    <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:14px;">
      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Abonnements gÃ©nÃ©rÃ©s</div>
        <div style="font-size:20px;font-weight:700;">
          {{ total_sales or 0 }}
        </div>
      </div>

      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Commissions estimÃ©es</div>
        <div style="font-size:20px;font-weight:700;">
          {{ "%.2f"|format(total_commission or 0) }} â‚¬
        </div>
      </div>

      <div style="
            flex:1 1 120px;
            min-width:120px;
            padding:12px 12px 10px;
            border-radius:16px;
            border:1px solid var(--border);
            background:#020617;
          ">
        <div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Clics sur votre lien</div>
        <div style="font-size:20px;font-weight:700;">
          {{ total_clicks or 0 }}
        </div>
      </div>
    </div>

    <!-- Lien Ã  partager -->
    <div style="
          margin-top:6px;
          padding:12px 13px;
          border-radius:16px;
          border:1px solid rgba(148,163,184,0.6);
          background:rgba(15,23,42,0.9);
          font-size:13px;
        ">
      <div style="font-weight:600;margin-bottom:6px;">Votre lien Betty Bot Ã  partager</div>
      <p style="margin-bottom:6px;color:var(--muted);">
        Tous les abonnements pris via ce lien sont automatiquement associÃ©s Ã  votre compte ambassadeur.
      </p>
      <p style="word-break:break-all;margin-bottom:6px;">
        <a href="{{ betty_link }}" target="_blank" rel="noopener"
           style="color:#a5b4fc;text-decoration:underline;">
          {{ betty_link }}
        </a>
      </p>
      <p style="font-size:11px;color:var(--muted);">
        Utilisez-le dans vos emails, messages privÃ©s, publications rÃ©seaux sociaux, etc.
      </p>
    </div>

    <!-- Rappel commissions -->
    <div style="margin-top:14px;font-size:12px;color:var(--muted);">
      Rappel : vous touchez <strong>30&nbsp;% de la premiÃ¨re mensualitÃ©</strong> (â‰ˆ24&nbsp;â‚¬)
      puis <strong>10&nbsp;â‚¬ / mois</strong> tant que chaque abonnement reste actif.
      Les versements sont effectuÃ©s sur le mode de paiement indiquÃ© lors de votre inscription.
    </div>

    <!-- Bouton Demander mon virement -->
    <div style="margin-top:18px;">
      <a
        href="mailto:spectramediabots@gmail.com?subject=Demande%20de%20virement%20Ambassadeur%20Betty%20Bot&body=Bonjour%2C%0A%0AJe%20souhaite%20demander%20le%20virement%20de%20mes%20commissions%20d%27ambassadeur.%0A%0ANom%20:%20{{ (ambassador.name or '')|urlencode }}%0AEmail%20:%20{{ ambassador.email|urlencode }}%0ACode%20ambassadeur%20:%20{{ ambassador.code|urlencode }}%0AMontant%20estim%C3%A9%20:%20{{ '%.2f'|format(total_commission or 0) }}%20%E2%82%AC%0A%0AMerci%20!%0A"
        style="
          display:inline-block;
          padding:11px 22px;
          border-radius:999px;
          background:linear-gradient(90deg,#22c55e,#3b82f6);
          color:#0f172a;
          font-weight:600;
          font-size:14px;
          text-decoration:none;
          box-shadow:0 10px 30px rgba(34,197,94,0.4);
        ">
        ğŸ’¸ Demander mon virement
      </a>
      <p style="font-size:11px;color:var(--muted);margin-top:6px;max-width:360px;">
        Le montant indiquÃ© est une estimation. Le versement rÃ©el sera calculÃ© Ã  partir des abonnements effectivement payÃ©s via votre lien.
      </p>
    </div>
  </div>

  <!-- Colonne droite : scripts + explication client -->
  <div style="
        flex:1 1 320px;
        min-width:280px;
        border-radius:var(--radius-xl);
        border:1px solid var(--border);
        background:radial-gradient(circle at top right,rgba(99,102,241,0.25),#020617 55%);
        padding:22px 20px 22px;
      ">
    <!-- En-tÃªte outils -->
    <div style="margin-bottom:14px;">
      <div style="font-size:13px;color:var(--muted);margin-bottom:4px;">
        Outils pour vendre Betty Bot
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <div style="
              padding:6px 10px;
              border-radius:999px;
              border:1px solid rgba(148,163,184,0.6);
              font-size:11px;
              background:rgba(15,23,42,0.9);
            ">
          Scripts conseillÃ©s
        </div>
        <div style="
              padding:6px 10px;
              border-radius:999px;
              border:1px solid rgba(148,163,184,0.35);
              font-size:11px;
              background:rgba(15,23,42,0.6);
            ">
          Parcours client
        </div>
      </div>
    </div>

    <!-- Scripts de vente -->
    <div style="
          padding:12px 13px;
          border-radius:16px;
          border:1px solid var(--border);
          background:#020617;
          font-size:13px;
          margin-bottom:14px;
        ">
      <h2 style="font-size:1rem;margin-bottom:6px;">Scripts pour convaincre vos clients</h2>
      <p style="color:var(--muted);margin-bottom:8px;">
        Deux scripts prÃªts Ã  lâ€™emploi que vous pouvez adapter Ã  votre ton.
      </p>

      <details open style="margin-bottom:8px;">
        <summary style="cursor:pointer;font-weight:600;margin-bottom:4px;">
          Script 1 â€“ Artisans / commerÃ§ants
        </summary>
        <pre style="
              white-space:pre-wrap;
              font-size:12px;
              margin-top:4px;
              background:#020617;
              border-radius:8px;
              padding:8px;
              border:1px solid rgba(31,41,55,0.9);
            ">
Bonjour, je me permets de vous contacter parce que je travaille avec un assistant virtuel
qui aide les artisans et commerÃ§ants Ã  ne plus perdre de clients quand ils sont occupÃ©s.

ConcrÃ¨tement, quand quelquâ€™un arrive sur votre site ou votre page, Betty discute avec lui,
pose quelques questions simples (nom, tÃ©lÃ©phone, ce quâ€™il cherche) et vous envoie tout
par email. Vous rappelez uniquement les personnes vraiment intÃ©ressÃ©es.

Ce nâ€™est pas un robot froid : elle parle comme une vraie personne, 24h/24,
et vous pouvez personnaliser son ton Ã  votre image. Lâ€™abonnement est Ã  79,90 â‚¬/mois,
sans engagement, et je peux vous envoyer un lien pour voir comment Ã§a fonctionne.

Est-ce que vous avez dÃ©jÃ  un site ou une page oÃ¹ on pourrait installer Betty Bot ?
            </pre>
      </details>

      <details>
        <summary style="cursor:pointer;font-weight:600;margin-bottom:4px;">
          Script 2 â€“ Coachs / thÃ©rapeutes / professions dâ€™accompagnement
        </summary>
        <pre style="
              white-space:pre-wrap;
              font-size:12px;
              margin-top:4px;
              background:#020617;
              border-radius:8px;
              padding:8px;
              border:1px solid rgba(31,41,55,0.9);
            ">
Je vous contacte parce que beaucoup de coachs et de thÃ©rapeutes perdent des demandes
de rendez-vous simplement parce quâ€™ils ne peuvent pas rÃ©pondre tout de suite.

Betty Bot est une assistante virtuelle spÃ©cialisÃ©e : elle accueille vos visiteurs,
explique votre activitÃ© avec vos mots, prend les coordonnÃ©es (nom, email, tÃ©lÃ©phone)
et le motif de la demande, puis vous envoie un rÃ©cap clair Ã  traiter quand vous Ãªtes disponible.

Lâ€™idÃ©e nâ€™est pas de remplacer votre relation humaine, mais de filtrer,
dâ€™organiser, et de rassurer les personnes qui arrivent chez vous de jour comme de nuit.

Lâ€™abonnement est Ã  79,90 â‚¬/mois, sans engagement. Si vous le souhaitez,
je vous envoie un lien de dÃ©monstration et vous verrez exactement
comment Betty peut travailler pour vous en arriÃ¨re-plan.
            </pre>
      </details>
    </div>

    <!-- Explication parcours client -->
    <div style="
          padding:12px 13px;
          border-radius:16px;
          border:1px solid var(--border);
          background:#020617;
          font-size:13px;
        ">
      <h2 style="font-size:1rem;margin-bottom:6px;">Comment Ã§a se passe pour vos clients&nbsp;?</h2>
      <ol style="margin-left:16px;color:var(--muted);line-height:1.6;">
        <li>
          <strong>Inscription Ã  Betty Bot</strong><br>
          Votre contact clique sur votre lien Betty Bot. Il arrive sur la page officielle,
          choisit son mÃ©tier, remplit ses informations, puis procÃ¨de au paiement
          sÃ©curisÃ© via Stripe (abonnement 79,90&nbsp;â‚¬ / mois).
        </li>
        <li>
          <strong>Configuration du chatbot</strong><br>
          AprÃ¨s paiement, il est redirigÃ© vers la page de configuration :
          couleur, avatar, message dâ€™accueil, texte dâ€™introduction, coordonnÃ©es de contact, etc.
          Tout se fait en quelques minutes.
        </li>
        <li>
          <strong>RÃ©ception du script par email</strong><br>
          Il reÃ§oit automatiquement un email avec son <strong>script dâ€™intÃ©gration</strong>
          (quelques lignes de code Ã  copier-coller).  
          Il doit vÃ©rifier ses spams si lâ€™email nâ€™apparaÃ®t pas.
        </li>
        <li>
          <strong>IntÃ©gration sur le site</strong><br>
          â€“ Sâ€™il gÃ¨re son site lui-mÃªme (WordPress, Wix, Webflowâ€¦), il ajoute simplement un
          Â«&nbsp;widget&nbsp;Â» ou un bloc Â«&nbsp;code HTML&nbsp;Â» et colle le script.<br>
          â€“ Sâ€™il travaille avec un dÃ©veloppeur ou une agence, il leur transmet lâ€™email :
          le script tient sur quelques lignes et sâ€™ajoute trÃ¨s facilement.
        </li>
        <li>
          <strong>Betty commence Ã  travailler</strong><br>
          Une fois le script en place, Betty apparaÃ®t sur le site et commence Ã  discuter
          avec les visiteurs. Les leads sont envoyÃ©s par email (et/ou dans lâ€™outil que
          vous prÃ©voyez ensuite).
        </li>
      </ol>
      <p style="font-size:12px;color:var(--muted);margin-top:8px;">
        Vous nâ€™avez rien Ã  gÃ©rer techniquement : votre rÃ´le est simplement dâ€™expliquer
        la valeur de Betty, dâ€™envoyer votre lien, et de suivre vos rÃ©sultats ici dans le dashboard.
      </p>
    </div>
  </div>
</section>

{% endif %}

<!-- Bouton contact global -->
<div style="margin-top:30px;text-align:center;">
  <a href="mailto:spectramediabots@gmail.com"
     style="
       display:inline-block;
       padding:10px 20px;
       border-radius:999px;
       border:1px solid rgba(148,163,184,0.7);
       background:#020617;
       color:#e5e7eb;
       font-size:13px;
       text-decoration:none;
     ">
    âœ‰ï¸ Contact â€“ spectramediabots@gmail.com
  </a>
</div>

{% endblock %}
